define(["jquery","underscore"],function(a,b){var c="_tight",d=function(a,c,d,e,f,g,h,i,j,k,l,m){j||(j=0),k||(k=0),b(h).times(function(b){++b,1==k&&"summon"==l?a.append('<div class="'+f+'-on"></div>'):1!=j&&1!=m||"weapon"!=l?h-i>=b?g>=b?a.append('<div class="'+c+'-on"></div>'):a.append('<div class="'+c+'-off"></div>'):i>0&&(g>=b?a.append('<div class="'+d+'-on"></div>'):a.append('<div class="'+d+'-off"></div>')):j&&b>g?a.append('<div class="'+c+'-off"></div>'):3>=b?a.append('<div class="'+e+'-on"></div>'):b>3&&a.append('<div class="'+d+'-on"></div>')})},e=function(a,d,e,f,g,h,i,j,k,l,m,n){var o,p="",q=!0,r=[],s=n||h>=5&&("weapon"===l||"summon"===l)?c:"";return j||(j=0),k||(k=0),b(h).times(function(b){++b,"summon"==l&&1==k?(p=f,q=!1):1!=j&&1!=m||"weapon"!=l?h-i>=b?(p=a,q=b>g):i>0&&(p=d,q=b>g):j&&b>g?(q=!0,p=a):(q=!1,p=3>=b?e:d),starState=q?"off":"on",o='<div class="'+p+"-"+starState+" "+s+'"></div>',r+=o}),r};return{renderDetailStar:d,listStarHtml:e,DISPLAY_TIGHT_CLASS:c}});