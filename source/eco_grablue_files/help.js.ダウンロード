define(["underscore","backbone","flexslider"],function(a,b,c){var d=420,e=10,f="completeRemoveHelpPop",g=b.View.extend({el:"#pop-help",defaults:{className:null,startAt:0,list:[],gcCoinImgFlags:[],exchangeShopId:null,mustCheckLast:!1},currentSlide:0,events:{"tap .btn-help-next":"goForward","tap .img-has-next-tips":"goForward"},initialize:function(){this.setElement(this.el),this.options=a.extend({},this.defaults,this.options),this.currentSlide=this.options.startAt},render:function(){return this.$el.html(a.template($("#tpl-pop-help").html(),this.options)),this.$el.find(".prt-help-list").flexslider({selector:".prt-help-wrapper > .lis-help",animation:"slide",animationLoop:!1,slideshow:!1,prevText:"",nextText:"",startAt:this.options.startAt,start:function(){$(".flex-control-nav a").text("")},after:this.getFuncOnSlide()}),this.options.mustCheckLast&&this.options.list.length>1&&(this.$el.find(".img-help:not(:last)").addClass("img-has-next-tips"),this.renderButtonWhenMustCheckLast(!1)),this},popShow:function(a,b){$(".mask").css("display","block");var c=this.$el.find(".pop-help"),f=Math.min(d,c.height()),g=($(window).height()-53*window.deviceRatio)/2,h=f/2*window.deviceRatio,i=Number($("html").height()),j=Game.get$ScrollParent().scrollTop();if(Game.ua.isJssdk()){var k=$(Game.gameContainer.selector);i=Number(k.height())}var l=j/window.deviceRatio,m=0;m=0>g-h?l+e:g-h+l;var n=+m+ +f,o=+i-50*window.deviceRatio-n;0>o&&(m=l+e),c.css({display:"block",opacity:"0",top:m+"px","margin-bottom":0>o?"53px":"0"}),setTimeout(function(c){if(c.css("opacity","1"),a&&b){var d=a,e=+d+ +c.height(),f=+i-50*window.deviceRatio-e;0>f&&(d+=f),c.animate({top:d+"px"},b)}},100,c)},popRemove:function(){$(".mask").css("display","none"),this.$el.find(".pop-help").css("display","none"),this.$el.empty(),this.trigger(f),this.popOff()},popOff:function(){this.off(),this.undelegateEvents(),this.stopListening()},COMPLETE_REMOVE_EVENT:f,getFuncOnSlide:function(){return this.options.mustCheckLast&&this.options.list.length>1?this.onSlideWhenMustCheckLast.bind(this):function(){}},onSlideWhenMustCheckLast:function(a){this.currentSlide=a.currentSlide,this.currentSlide+1>=this.options.list.length&&(this.renderButtonWhenMustCheckLast(!0),a.vars.after=function(){this.currentSlide=a.currentSlide}.bind(this))},renderButtonWhenMustCheckLast:function(b){this.$el.find(".prt-buttons-area").html(a.template($("#tpl-help-button-when-must-check-last").html(),{isLastChecked:b}))},goForward:function(a){a.preventDefault(),this.currentSlide+1>=this.options.list.length||this.$el.find(".prt-help-list").flexslider(this.currentSlide+1)}});return g});