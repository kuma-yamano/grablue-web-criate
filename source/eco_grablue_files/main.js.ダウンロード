define(["backbone","model/content","view/content","view/raid/setup","util/local-storage"],function(a,b,c,d,e){var f="app",g="chromeapp",h="shellapp",i=c.extend({content_model:null,raid_id:null,action:null,events:{"tap .cnt-raid-header":"dispatchCanvasTap","touchstart .cnt-raid-header":"dispatchCanvasTap","touchend .cnt-raid-header":"dispatchCanvasTap"},dispatchCanvasTap:function(a){if("undefined"!=typeof a.originalEvent){var b="touchstart"===a.type?"pressdown":"pressup",c=a.x||a.originalEvent.changedTouches[0].clientX||a.originalEvent.touches[0].clientX,d=a.y||a.originalEvent.changedTouches[0].clientY||a.originalEvent.touches[0].clientY,e=new createjs.MouseEvent(b,!0,!1,c,d,a,-1,!0,c,d);"pressdown"===b?stage._handlePointerDown(-1,e,c,d):stage._handlePointerUp(-1,e,!1)}},initialize:function(a){this.raidMainInitialize(a)},raidMainInitialize:function(a){var c=this;this.content_bind(),this.reload_flg=!1,null!=e.get("hold_raid")&&(e.get("hold_raid")==location.hash&&null==e.get("return_raid_url")&&(this.reload_flg=!0),e.remove("hold_raid")),e.set("hold_raid",location.hash),e.get("return_raid_url")==location.hash||this.reload_flg||(e.remove("cheer_already"),e.remove("cheer_compleate"),e.remove("cheer_effect_text"),e.remove("cheer_pop_flg"),e.remove("popCheer_cancel"),e.remove("lose_pop_flg")),e.remove("return_raid_url");var d={raid_id:a.raid_id};this.raid_id=a.raid_id,this.action=a.action,this.is_multi=a.is_multi,this.is_semi=a.is_semi,a.speed&&(this.speed=a.speed,d.speed=this.speed),a.lock&&(this.lock=a.lock),a.cmd&&(this.cmd=a.cmd,this.uid=a.uid,this.stp=a.stp,this.trn=a.trn,this.fwd=a.fwd,this.tgt=a.tgt,this.questType=a.questType,d.cmd=this.cmd,d.uid=this.uid,d.stp=this.stp,d.trn=this.trn,d.fwd=this.fwd,d.tgt=this.tgt,d.quest_type=this.questType),a.is_semi?this.content_model=new b({controller:"semiraid",action:"index",param:d}):a.is_multi?this.content_model=new b({controller:"multiraid",action:"index",param:d}):this.content_model=new b({controller:"raid",action:"index",param:d}),this.listenToOnce(this.content_model,"change",this.render),this.content_model.fetch(),$(window).on("orientationchange",function(){stage.alpha=0;var a=c.$el.find(".lis-log");a.css("display","none"),setTimeout(function(){window.scrollTo(0,0),stage.alpha=1,a.show()},1e3)})},render:function(){this.content_render(this.content_model);var a={raid_id:this.raid_id,action:this.action,is_multi:this.is_multi,is_semi:this.is_semi};return this.speed&&(a.speed=this.speed),this.lock&&(a.lock=this.lock),this.cmd&&(a.cmd=this.cmd,a.uid=this.uid,a.stp=this.stp,a.trn=this.trn,a.fwd=this.fwd,a.tgt=this.tgt,a.quest_type=this.questType),this.reload_flg&&(a.reload_flg=this.reload_flg),this.reload_flg&&(a.reload_flg=this.reload_flg),this.setupView=new d(a),this.addSubView(this.setupView),Game.ua.isChromeApp()?this.$el.find(".cnt-raid").addClass(f+" "+g):Game.shellAppFlag&&this.$el.find(".cnt-raid").addClass(f+" "+h),this.trigger("loadEnd"),this}});return i});